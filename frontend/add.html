<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Artikel einstellen — rently</title>
  <link rel="stylesheet" href="assets/css/styles.css">
</head>
<body>
<header class="site-header">
  <div class="container">
    <a class="logo" href="index.html"><img src="assets/img/rently-logo.svg" alt="Rently" height="32"></a>
    <nav class="nav">
      <a href="catalog.html">Katalog</a>
      <a href="add.html" class="cta">Artikel einstellen</a>
    </nav>
  </div>
</header>

<main class="container">
  <h1>Artikel einstellen</h1>

  <form id="add-form" class="form">
    <label>Titel* <input name="title" required placeholder="Bohrhammer Bosch GBH 2-28"></label>

    <label>Kategorie*
      <select name="category_code" required>
        <option value="tools">Werkzeuge</option>
        <option value="electronics">Elektronik</option>
        <option value="sports">Sport</option>
        <option value="party">Partyartikel</option>
        <option value="kids">Kinderbedarf</option>
      </select>
    </label>

    <label>Bezirk*
      <select name="district" required>
        <option value="Mitte">Mitte</option>
        <option value="Friedrichshain-Kreuzberg">Friedrichshain-Kreuzberg</option>
        <option value="Pankow">Pankow</option>
        <option value="Charlottenburg-Wilmersdorf">Charlottenburg-Wilmersdorf</option>
        <option value="Spandau">Spandau</option>
        <option value="Steglitz-Zehlendorf">Steglitz-Zehlendorf</option>
        <option value="Tempelhof-Schöneberg">Tempelhof-Schöneberg</option>
        <option value="Neukölln">Neukölln</option>
        <option value="Treptow-Köpenick">Treptow-Köpenick</option>
        <option value="Marzahn-Hellersdorf">Marzahn-Hellersdorf</option>
        <option value="Lichtenberg">Lichtenberg</option>
        <option value="Reinickendorf">Reinickendorf</option>
      </select>
    </label>

    <label>Preis pro Tag (€)* <input name="price_per_day" type="number" min="1" required></label>
    <label>Bild-URL <input name="image_url" placeholder="https://…"></label>
    <label>Beschreibung <textarea name="description" placeholder="Zustand, Zubehör, Übergabe…"></textarea></label>
    <label>Telefon <input name="phone" placeholder="+49…"></label>
    <label>Telegram <input name="telegram" placeholder="@username"></label>

    <button type="submit" class="btn primary">Veröffentlichen</button>
  </form>

  <div id="add-note" class="muted" style="margin-top:8px;"></div>
</main>

<footer class="site-footer">
  <div class="container footer-grid">
    <div>rently — MVP</div>
    <div><a href="about.html">Über das Projekt</a></div>
  </div>
</footer>

<script type="module">
  const DATA_URL = '/items';
  const form = document.getElementById('add-form');
  const note = document.getElementById('add-note');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    note.textContent = 'Sende…';

    const fd = new FormData(form);
    const payload = {
      title: (fd.get('title') || '').trim(),
      category_code: fd.get('category_code'),
      district: fd.get('district'),
      price_per_day: Number(fd.get('price_per_day')),
      image_url: (fd.get('image_url') || '').trim(),
      description: (fd.get('description') || '').trim(),
      phone: (fd.get('phone') || '').trim(),
      telegram: (fd.get('telegram') || '').trim()
    };

    try {
      const res = await fetch(DATA_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      });
      if (!res.ok) throw new Error('HTTP ' + res.status);
      const created = await res.json();

      note.textContent = 'Fertig! Weiterleitung…';
      location.href = `catalog.html?added=${encodeURIComponent(created.id)}&category=${encodeURIComponent(created.category_code)}`;
    } catch (err) {
      console.error(err);
      note.textContent = 'Fehler beim Senden. Bitte Daten und Server prüfen.';
    }
  });
</script>
</body>
</html>
